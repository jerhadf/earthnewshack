import { Auth } from "../authentication.js";
import { performAsyncSyscall, performSyscall } from "./syscall.js";

export function setupAuth(): Auth {
  return {
    getUserIdentity: async () => {
      return await performAsyncSyscall("getUserIdentity", {});
    },
  };
}

export function setupActionAuth(requestId: string): Auth {
  return {
    getUserIdentity: () => {
      const syscallJSON = performSyscall("actions/getUserIdentity", {
        requestId,
      });
      return Promise.resolve(syscallJSON);
    },
  };
}
